\section{Graph Grammars}\label{sec:graph}
A \textit{Graph Grammar} (GG) is composed of a set of graph transformation rules. These rules indicate how a graph can be transformed to a new graph. These graphs are called \textit{host graphs}. The rules are composed of graphs themselves, which are called \textit{rule graphs}.

The rest of this section is ordered as follows: first, host graphs are explained. This is then used to explain graph transformation rules. Then, the definition of a \textit{Graph Transition System} (GTS) is given. An example of a GG and a GTS is then given. Finally, a method for transforming a GTS to an STS is given. For a more detailed overview of GGs, we refer to~\cite{Rensink:graph_grammars, Heckel2006187, Andries1999}.

\subsection{Graphs and morphisms}
In this report, we assume a universe of nodes $\Nodes$\newnot{symbol:Nodes} such that $\mathbb{U} \subset \Nodes$, $\Variables \subset \Nodes$ and $\FunctionSymbols^0 \subset \Nodes$.

A graph $\hostGraph$ is a tuple $\langle \DefinedNodes, \DefinedEdges\rangle$\newnot{symbol:hostGraph}, where:
\begin{itemize}
  \item $\DefinedNodes \subseteq (\Nodes \backslash \FunctionSymbols^0)$
  \item $\DefinedEdges$ is a set of edges, where each $\edge \in \DefinedEdges$ has a label and source and target nodes in $\DefinedNodes$
\end{itemize}

A graph $H$ has an \textit{occurrence} in a graph $\hostGraph$ if there is a structure-preserving mapping from the nodes and the edges of $H$ to the nodes and the edges of $\hostGraph$ respectively. Such a mapping is called a \textit{morphism}. A node or edge $x$ in graph $H$ is then said to have an \textit{image} in graph $\hostGraph$ and $x$ is a \textit{pre-image} of the image. A graph $H$ has a partial morphism to a graph $\hostGraph$ if there are elements in $H$ without an image in $\hostGraph$.

\subsection{Rule graphs}
A rule graph $\ruleGraph$ is a tuple $\langle \DefinedRuleNodes, \DefinedRuleEdges, \FunctionSymbols \rangle$\newnot{symbol:ruleGraph}, where:
\begin{itemize}
  \item $\DefinedRuleNodes \subseteq (\Nodes \backslash \mathbb{U})$
  \item $\DefinedRuleEdges$ is a set of edges, where each $\edge \in \DefinedRuleEdges$ has a label and source and target nodes in $\DefinedRuleNodes$
  \item The function symbols have to form the terms over the constants matched by the constant symbols.
\end{itemize}

A variable $\variable \in \Variables^{\sort}, \sort \in \Sorts$, can have an image $i$ in a graph if $i \in \mathbb{U}^{\sort}$. A constant symbol $c \in \FunctionSymbols^0$ can have an image $i$ in a graph if $i \in \mathbb{U}^{\sort}$ and $i$ is represented by the constant symbol $c$ in the signature.

\subsection{Graph transformation rules}\label{sec:graph_rules}
\vspace{5px}
\begin{definition}
A transformation rule is a tuple $\langle \mathit{LHS}, \mathit{NAC}, \mathit{RHS}\rangle$, where:
\begin{itemize}
  \item $\mathit{LHS}$ is a rule graph representing the left-hand side of the rule
  \item $\mathit{NAC}$ is a set of rule graphs representing the negative application conditions
  \item $\mathit{RHS}$ is a rule graph representing the right-hand side of the rule
\end{itemize}
\end{definition}

\begin{comment}\begin{definition}
$\mathit{LHS}$ is a tuple $\langle \mathcal{V}_{LHS}, \mathcal{E}_{LHS}, \mathcal{O}_{LHS} \rangle$, where $\mathcal{O}_{LHS} \subseteq \mathcal{V}^n \times O_p \times \mathcal{V}$.
\end{definition}\end{comment}

A rule $R$ is applicable on a graph $G$ if its $\mathit{LHS}$ has an occurrence in $G$ and $\not\exists\,n \in \mathit{NAC}$ such that $n$ has an occurence in $G$ and $\forall\,e \in \mathit{LHS}$, if $e$ has an image $i$ in $n$, and an image $j$ in $G$, then $j$ should be an image of $i$.

This 'applicability' as defined here is refered to as a rule \textit{match}. After the rule match is applied to the graph, all elements in $\mathit{LHS}$ that do not have an image in $\mathit{RHS}$, are removed from $G$ and all elements in $\mathit{RHS}$ that do not have a pre-image in $\mathit{LHS}$, are added to $\hostGraph$.

\subsection{Graph Transition Systems}
By repeatedly applying graph transformation rules to the start graph and all its consecutive graphs, a GG can be explored to reveal a \textit{Graph Transition System} (GTS). This transition system consists of graphs connected by \textit{rule transitions}.
\vspace{5px}
\begin{definition}
A graph transition system is a tuple	$\langle \Graphs, \Rules, \RuleTransitions, \startGraph\rangle$, where:
\begin{itemize}
\item $\Graphs$\newnot{symbol:Graphs} is a set of graphs
\item $\Rules$\newnot{symbol:Rules} is a set of transformation rules
\item $\RuleTransitions \in \Graphs \times \Rules \times \Graphs$\newnot{symbol:RuleTransitions} is the rule transition relation
\item $\startGraph \in \Graphs$\newnot{symbol:startGraph} is the initial graph
\end{itemize}
We write $\hostGraph \xrightarrow{\ggrule}\hostGraph'$ if there is a rule transition with rule $\ggrule$ from graph $\hostGraph$ to $\hostGraph'$, i.e., $(\hostGraph, \ggrule, \hostGraph') \in \RuleTransitions$.
\end{definition}

\subsection{Example}\label{sec:gts_example}
Figure \ref{fig:gts} shows an example of the initial graph and one rule of a GG. The initial graph can be represented by $\langle\{n1,n2\},\{\langle n1,a,n1\rangle, \langle n1,A,n2\rangle,\langle n2,B,n2\rangle\}\rangle$. The $\mathit{LHS}$ of the rule has an occurrence in the initial graph. None of the graphs in the $\mathit{NAC}$ have an occurrence in the initial graph, because the edge with label $C$ does not exist in the initial graph. The new graph after applying the rule is in Figure~\ref{fig:gg_result}.

\begin{figure}[ht]
  \begin{center}
    \subfloat[The initial graph]{\label{fig:gg_graph}\input{./img/gg_graph.tex}}\hspace{20px}
    \subfloat[The LHS]{\label{fig:gg_lhs}\input{./img/gg_lhs.tex}}\hspace{20px}
    \subfloat[The first NAC]{\label{fig:gg_nac1}\input{./img/gg_nac1.tex}}
    
    \subfloat[The second NAC]{\label{fig:gg_nac2}\input{./img/gg_nac2.tex}}\hspace{20px}
    \subfloat[The RHS]{\label{fig:gg_rhs}\input{./img/gg_rhs.tex}}\hspace{20px}
    \subfloat[The result]{\label{fig:gg_result}\input{./img/gg_result.tex}}
  \end{center}
  \caption{An example of a GG}
  \label{fig:gts}
\end{figure}\marginpar{This picture needs to be placed in a structure, need a way of nesting graphs...}

\subsection{Input-Output GGs}
In order to specify stimuli and responses with GGs, a definition is given for an \textit{Input-Output GG} (IOGG). Concretely, the IOGG places input and output labels on its rule transitions. Following the definition from IOLTSs, each rule transition label $l \in L$ has a type $\iotype \in \IOTypes$. Exploring an IOGG leads to an \textit{Input-Output Graph Transition System} (IOGTS).
