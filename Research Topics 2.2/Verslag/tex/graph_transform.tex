\section{Graph Grammars}\label{sec:graph}
A Graph Grammar is composed of a start graph and a set of transition rules. The start graph describes the system in its initial state. The transition rules apply changes to the graph, creating a new graph which describes the system in its new state. 

\subsection{Graphs \& Morphisms}
\begin{definition}
A graph is a tuple $\langle L, N, E\rangle$, where:
\begin{itemize}
  \item $L$ is a set of labels
  \item $N$ is a set of nodes, where each $n \in N$ has a label $l \in L$
  \item $E$ is a set of edges, where each $e \in E$ has a label $l \in L$ and nodes $source,target \in N$
\end{itemize}
\end{definition}

%A graph $H$ is a \textit{subgraph} of graph $G$, denoted $H \subseteq G$, if the node and edge sets of $H$ are subsets of the node and edge sets of $G$, where nodes are considered equal if their labels are equal and edges are considered equal if their labels and their source and target nodes are equal.

A graph $H$ has an \textit{occurrence} in a graph $G$, denoted by $H \rightarrow G$, if there is a mapping $occ$ which maps the nodes and the edges of $H$ to the nodes and the edges of $G$ respectively. Such a mapping is called a \textit{morphism}. An element $e$ in graph $H$ is then said to have an \textit{image} in graph $G$ and $e$ is a \textit{pre-image} of the image. A graph $H$ has a partial morphism to a graph $G$ if there are elements in $H$ without an image in $G$.

\subsection{Graph transformation rules}
\begin{definition}
A transformation rule is a tuple $\langle \mathit{LHS}, \mathit{NAC}, \mathit{RHS}, \mathit{M}\rangle$, where:
\begin{itemize}
  \item $\mathit{LHS}$ is a graph representing the left-hand side of the rule
  \item $\mathit{NAC}$ is a set of graphs representing the negative application conditions
  \item $\mathit{RHS}$ is a graph representing the right-hand side of the rule
  \item $\mathit{M_RHS}$ is a partial morphism of $\mathit{LHS}$ to $\mathit{RHS}$ 
  \item $\mathit{M_NAC}$ are partial morphisms of $\mathit{LHS}$ to each $n \in \mathit{NAC}$
\end{itemize}
\end{definition}

A rule $R$ is applicable on a graph $G$ if its $\mathit{LHS}$ has an occurrence in $G$ and $\not\ exists n \in \mathit{NAC}$ such that $n$ has an occurence in $G$ and $\forall e \in \mathit{LHS}$, if $e$ has an image $i$ in $n$ and an image $j$ in $G$, then $j$ should be an image of $j$. After the rule application, all elements in $\mathit{LHS}$ not part of $\mathit{M_RHS}$, i.e. they do not have an image in $\mathit{RHS}$, are removed from $G$ and all elements in $\mathit{RHS}$ not part of $\mathit{M_RHS}$, i.e. they do not have a pre-image in $\mathit{LHS}$, are added to $G$.

\subsection{Graph Grammars}
Now Graph Grammars can be defined.
\begin{definition}
A Graph Grammar is a tuple $\langle G, R\rangle$, where:
\begin{itemize}
  \item $G$ is a graph of the start state
  \item $R$ is a set of transformation rules
\end{itemize}
\end{definition}

\subsection{Graph Transition Systems}
Through repeated rule transformation, a graph grammar can be explored to reveal a \textit{Graph Transition System} (GTS). This transition system consists of \textit{graph states} connected by \textit{rule transitions}.

\begin{definition}
A graph transition system is an 8-tuple	$\langle S, L, T, G, R, M_G, M_R, s0\rangle$, where:
\begin{itemize}
\item $S$ is a finite, non-empty set of graph states
\item $L$ is a finite set of labels. The arity of a label $l\in L$, denoted $arity(l)$, is a natural number. The parameters of a label $l\in L$, denoted $param(l)$, are a tuple of length $arity(l)$ of constants.
\item $T \in S \times (L \cup \{\tau\}) \times S$, with $\tau \notin L$, is the rule transition relation
\item $G$ is a set of graphs
\item $R$ is a set of rules
\item $M_G$ is a mapping $\forall s \in S . s \mapsto g \in G \land \not\exists s' \in S . s \neq s' \land s' \mapsto g \in M_G$
\item $M_R$ is a mapping $\forall t \in T . t \mapsto r \in R \land \not\exists t' \in T . t \neq t' \land t' \mapsto r \in M_R$
\item $s0 \in s$ is the initial graph state
\end{itemize}
We write $s \xrightarrow{\mu}s'$ if there is a rule transition labelled $\mu$ from state s to state s', i.e., $(s, \mu, s') \in T$.
\end{definition}

This structure resembles that of an LTS; by repeatedly applying all applicable transformation rules to each graph state until no new graph states can be explored, the complete graph transition system is found.

\subsection{GTS to STS transformation}\marginpar{expand, check}
In this section, a basic method to transform a GTS to an STS is described. The resulting STS is reducible to a smaller STS.

For each graph state $s \in S$ create a location $l \in L$. The start location $l_0 \in L$ is the location created by the state $s0 \in S$. Make $\mathcal{V}$ an empty set and $\imath$ an empty mapping. For each label $l \in L$ create a gate $\lambda \in \Lambda$. For each $p \in \mathit{param}(l)$ create an interaction variable $i \in \mathcal{I}$ of the same type as $p$ and add $i$ to $param(\lambda)$. Set $\mathit{arity}(\lambda)$ to $\mathit{arity}(l)$. For each rule transition $t \in T$ create a switch relation $r \in \rightarrow$, where:
\begin{itemize}
  \item the source and the target locations of the switch relation are the locations created by the source and target graph states of the rule transition.
  \item the gate of the switch relation is the gate created by the label on the transition.
  \item for each $p \in \mathit{params}(l)$ and $i \in \mathcal{I}$ created by $p$ create an $i = p$ expression. The guard of the switch relation is those expressions joined by the $\land$ operator.
  \item create an empty update mapping for the switch relation.
\end{itemize}

An example of such a transformation is done using the GTS in Figure~\ref{fig:trafo_lts}. The basic STS resulting from the transformation is in Figure~\ref{fig:trafo_basic_sts}.

\begin{figure}[h]
  \begin{center}
    \input{./img/trafo_basic_sts.tex}
  \end{center}
  \caption{The basic STS resulting from the transformation of the LTS in Figure~\ref{fig:trafo_lts}}
  \label{fig:trafo_basic_sts}
\end{figure}

This basic STS maintains the behavior of the system.

\subsection{Example}\label{sec:gts_example}
\marginpar{put here example in line with the definitions above}
